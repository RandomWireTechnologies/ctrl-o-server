!function (window, document, $) {
    "use strict";

    $('#wizard-form').smartWizard();

    $('#wizard_verticle').smartWizard({
        transitionEffect: 'slide'
    });

    $('.buttonPrevious').addClass('btn btn-success waves-effect waves-light');
    $('.buttonNext').addClass('btn btn-info waves-effect waves-light pull-right');
//------------------/
    // Smart Wizard     	
    $('#wizard').smartWizard({transitionEffect: 'slideleft', onLeaveStep: leaveAStepCallback, onFinish: onFinishCallback, enableFinishButton: true});

    function leaveAStepCallback(obj) {
        var step_num = obj.attr('rel');
        return validateSteps(step_num);
    }

    function onFinishCallback() {
        if (validateAllSteps()) {
            $('form').submit();
        }
    }
}(window, document, jQuery);

function validateAllSteps() {
    var isStepValid = true;

    if (validateStep1() == false) {
        isStepValid = false;
        $('#wizard').smartWizard('setError', {stepnum: 1, iserror: true});
    } else {
        $('#wizard').smartWizard('setError', {stepnum: 1, iserror: false});
    }
    
    if (validateStep2() == false) {
        isStepValid = false;
        $('#wizard').smartWizard('setError', {stepnum: 2, iserror: true});
    } else {
        $('#wizard').smartWizard('setError', {stepnum: 2, iserror: false});
    }

    if (validateStep3() == false) {
        isStepValid = false;
        $('#wizard').smartWizard('setError', {stepnum: 3, iserror: true});
    } else {
        $('#wizard').smartWizard('setError', {stepnum: 3, iserror: false});
    }

    if (!isStepValid) {
        $('#wizard').smartWizard('showMessage', 'Please correct the errors in the steps and continue');
    }

    return isStepValid;
}


function validateSteps(step) {
    var isStepValid = true;
    // validate step 1
    if (step == 1) {
        if (validateStep1() == false) {
            isStepValid = false;
            $('#wizard').smartWizard('showMessage', 'Please correct the errors in step' + step + ' and click next.');
            $('#wizard').smartWizard('setError', {stepnum: step, iserror: true});
        } else {
            $('#wizard').smartWizard('setError', {stepnum: step, iserror: false});
        }
    }

    // validate step 2
    if (step == 2) {
        if (validateStep2() == false) {
            isStepValid = false;
            $('#wizard').smartWizard('showMessage', 'Please correct the errors in step' + step + ' and click next.');
            $('#wizard').smartWizard('setError', {stepnum: step, iserror: true});
        } else {
            $('#wizard').smartWizard('setError', {stepnum: step, iserror: false});
        }
    }
    
    // validate step3
    if (step == 3) {
        if (validateStep3() == false) {
            isStepValid = false;
            $('#wizard').smartWizard('showMessage', 'Please correct the errors in step' + step + ' and click next.');
            $('#wizard').smartWizard('setError', {stepnum: step, iserror: true});
        } else {
            $('#wizard').smartWizard('setError', {stepnum: step, iserror: false});
        }
    }

    return isStepValid;
}

function validateStep1() {
    var isValid = true;
    // Validate Username
    var un = $('#username').val();
    if (!un && un.length <= 0) {
        isValid = false;
        $('#msg_username').html('Please fill username').show();
    } else {
        $('#msg_username').html('').hide();
    }

    // validate password
    var pw = $('#password').val();
    if (!pw && pw.length <= 0) {
        isValid = false;
        $('#msg_password').html('Please fill password').show();
    } else {
        $('#msg_password').html('').hide();
    }

    // validate confirm password
    var cpw = $('#cpassword').val();
    if (!cpw && cpw.length <= 0) {
        isValid = false;
        $('#msg_cpassword').html('Please fill confirm password').show();
    } else {
        $('#msg_cpassword').html('').hide();
    }

    // validate password match
    if (pw && pw.length > 0 && cpw && cpw.length > 0) {
        if (pw != cpw) {
            isValid = false;
            $('#msg_cpassword').html('Password mismatch').show();
        } else {
            $('#msg_cpassword').html('').hide();
        }
    }
    return isValid;
}

function validateStep2() {
    var isValid = true;

    // Validate Firstname
    var un = $('#firstname').val();
    if (!un && un.length <= 0) {
        isValid = false;
        $('#msg_firstname').html('Please fill firstname').show();
    } else {
        $('#msg_firstname').html('').hide();
    }
    
    // Validate Lastname
    var un = $('#lastname').val();
    if (!un && un.length <= 0) {
        isValid = false;
        $('#msg_lastname').html('Please fill lastname').show();
    } else {
        $('#msg_lastname').html('').hide();
    }
    
    return isValid;
}

function validateStep3() {
    var isValid = true;
    //validate email  email
    var email = $('#email').val();
    if (email && email.length > 0) {
        if (!isValidEmailAddress(email)) {
            isValid = false;
            $('#msg_email').html('Email is invalid').show();
        } else {
            $('#msg_email').html('').hide();
        }
    } else {
        isValid = false;
        $('#msg_email').html('Please enter email').show();
    }
    
    //validate phone
    var phone = $('#phone').val();
    if (phone && phone.length > 0) {
        if (!isValidPhoneNumber(phone)) {
            isValid = false;
            $('#msg_phone').html('Number is invalid').show();
        } else {
            $('#msg_phone').html('').hide();
        }
    } else {
        isValid = false;
        $('#msg_phone').html('Please enter number').show();
    }
    
    // Validate Address
    var un = $('#address').val();
    if (!un && un.length <= 0) {
        isValid = false;
        $('#msg_address').html('Please fill address').show();
    } else {
        $('#msg_address').html('').hide();
    }
    return isValid;
}

// Email Validation
function isValidEmailAddress(emailAddress) {
    var pattern = new RegExp(/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i);
    return pattern.test(emailAddress);
}

// phone Validation
function isValidPhoneNumber(phoneNumber) {
    var pattern2 = new RegExp(/^[0-9]+$/);
    return pattern2.test(phoneNumber);
}
//-------------------/

function countChecked() {
    "all" === checkState && $(".bulk_action input[name='table_records']").iCheck("check"), "none" === checkState && $(".bulk_action input[name='table_records']").iCheck("uncheck");
    var e = $(".bulk_action input[name='table_records']:checked").length;
    e ? ($(".column-title").hide(), $(".bulk-actions").show(), $(".action-cnt").html(e + " Records Selected")) : ($(".column-title").show(), $(".bulk-actions").hide())
}
var CURRENT_URL = window.location.href.split("?")[0], $BODY = $("body"), $MENU_TOGGLE = $("#menu_toggle"), $SIDEBAR_MENU = $("#sidebar-menu"), $SIDEBAR_FOOTER = $(".sidebar-footer"), $LEFT_COL = $(".left_col"), $RIGHT_COL = $(".right_col"), $NAV_MENU = $(".nav_menu"), $FOOTER = $("footer");
$(document).on("ready", function () {
    var e = function () {
        $RIGHT_COL.css("min-height", $(window).height());
        var e = $BODY.outerHeight(), t = $BODY.hasClass("footer_fixed") ? 0 : $FOOTER.height(), n = $LEFT_COL.eq(1).height() + $SIDEBAR_FOOTER.height(), i = n > e ? n : e;
        i -= $NAV_MENU.height() + t, $RIGHT_COL.css("min-height", i)
    };
    $SIDEBAR_MENU.find("a").on("click", function (t) {
        var n = $(this).parent();
        n.is(".active") ? (n.removeClass("active active-sm"), $("ul:first", n).slideUp(function () {
            e()
        })) : (n.parent().is(".child_menu") || ($SIDEBAR_MENU.find("li").removeClass("active active-sm"), $SIDEBAR_MENU.find("li ul").slideUp()), n.addClass("active"), $("ul:first", n).slideDown(function () {
            e()
        }))
    }), $MENU_TOGGLE.on("click", function () {
        $BODY.hasClass("nav-md") ? ($SIDEBAR_MENU.find("li.active ul").hide(), $SIDEBAR_MENU.find("li.active").addClass("active-sm").removeClass("active")) : ($SIDEBAR_MENU.find("li.active-sm ul").show(), $SIDEBAR_MENU.find("li.active-sm").addClass("active").removeClass("active-sm")), $BODY.toggleClass("nav-md nav-sm"), e()
    }), $SIDEBAR_MENU.find('a[href="' + CURRENT_URL + '"]').parent("li").addClass("current-page"), $SIDEBAR_MENU.find("a").filter(function () {
        return this.href == CURRENT_URL
    }).parent("li").addClass("current-page").parents("ul").slideDown(function () {
        e()
    }).parent().addClass("active"), $(window).smartresize(function () {
        e()
    }), e(), $.fn.mCustomScrollbar && $(".menu_fixed").mCustomScrollbar({autoHideScrollbar: !0, theme: "minimal", mouseWheel: {preventDefault: !0}})
}), $(document).on("ready", function () {
    $(".collapse-link").on("click", function () {
        var e = $(this).closest(".x_panel"), t = $(this).find("i"), n = e.find(".x_content");
        e.attr("style") ? n.slideToggle(200, function () {
            e.removeAttr("style")
        }) : (n.slideToggle(200), e.css("height", "auto")), t.toggleClass("fa-chevron-up fa-chevron-down")
    }), $(".close-link").on("click", function () {
        var e = $(this).closest(".x_panel");
        e.remove()
    })
}), $(document).on("ready", function () {
    $('[data-toggle="tooltip"]').tooltip({container: "body"})
}), $(".progress .progress-bar")[0] && $(".progress .progress-bar").progressbar(), $(document).on("ready", function () {
    if ($(".js-switch")[0]) {
        var e = Array.prototype.slice.call(document.querySelectorAll(".js-switch"));
        e.forEach(function (e) {
            new Switchery(e, {color: "#26B99A"})
        })
    }
}), $(document).on("ready", function () {
    $("input.flat")[0] && $(document).on("ready", function () {
        $("input.flat").iCheck({checkboxClass: "icheckbox_flat-green", radioClass: "iradio_flat-green"})
    })
}), $("table input").on("ifChecked", function () {
    checkState = "", $(this).parent().parent().parent().addClass("selected"), countChecked()
}), $("table input").on("ifUnchecked", function () {
    checkState = "", $(this).parent().parent().parent().removeClass("selected"), countChecked()
});
var checkState = "";
$(".bulk_action input").on("ifChecked", function () {
    checkState = "", $(this).parent().parent().parent().addClass("selected"), countChecked()
}), $(".bulk_action input").on("ifUnchecked", function () {
    checkState = "", $(this).parent().parent().parent().removeClass("selected"), countChecked()
}), $(".bulk_action input#check-all").on("ifChecked", function () {
    checkState = "all", countChecked()
}), $(".bulk_action input#check-all").on("ifUnchecked", function () {
    checkState = "none", countChecked()
}), $(document).on("ready", function () {
    $(".expand").on("click", function () {
        $(this).next().slideToggle(200), $expand = $(this).find(">:first-child"), "+" == $expand.text() ? $expand.text("-") : $expand.text("+")
    })
}), "undefined" != typeof NProgress && ($(document).on("ready", function () {
    NProgress.start()
}), $(window).load(function () {
    NProgress.done()
})), function (e, t) {
    var n = function (e, t, n) {
        var i;
        return function () {
            function c() {
                n || e.apply(a, o), i = null
            }
            var a = this, o = arguments;
            i ? clearTimeout(i) : n && e.apply(a, o), i = setTimeout(c, t || 100)
        }
    };
    jQuery.fn[t] = function (e) {
        return e ? this.bind("resize", n(e)) : this.trigger(t)
    }
}(jQuery, "smartresize");