$(function () {
    "use strict";

    var defaultData = [
        {
            text: 'Parent 1',
            href: '#parent1',
            tags: ['4'],
            nodes: [
                {
                    text: 'Child 1',
                    href: '#child1',
                    tags: ['2'],
                    nodes: [
                        {
                            text: 'Grandchild 1',
                            href: '#grandchild1',
                            tags: ['0']
                        },
                        {
                            text: 'Grandchild 2',
                            href: '#grandchild2',
                            tags: ['0']
                        }
                    ]
                },
                {
                    text: 'Child 2',
                    href: '#child2',
                    tags: ['0']
                }
            ]
        },
        {
            text: 'Parent 2',
            href: '#parent2',
            tags: ['0']
        },
        {
            text: 'Parent 3',
            href: '#parent3',
            tags: ['0']
        },
        {
            text: 'Parent 4',
            href: '#parent4',
            tags: ['0']
        },
        {
            text: 'Parent 5',
            href: '#parent5',
            tags: ['0']
        }
    ];

    var json = '[' +
            '{' +
            '"text": "Parent 1",' +
            '"nodes": [' +
            '{' +
            '"text": "Child 1",' +
            '"nodes": [' +
            '{' +
            '"text": "Grandchild 1"' +
            '},' +
            '{' +
            '"text": "Grandchild 2"' +
            '}' +
            ']' +
            '},' +
            '{' +
            '"text": "Child 2"' +
            '}' +
            ']' +
            '},' +
            '{' +
            '"text": "Parent 2"' +
            '},' +
            '{' +
            '"text": "Parent 3"' +
            '},' +
            '{' +
            '"text": "Parent 4"' +
            '},' +
            '{' +
            '"text": "Parent 5"' +
            '}' +
            ']';

    $('#basicTreeview').treeview({
        data: defaultData,
        nodeIcon: "icon icon_folder"
    });
    $('#treeviewCollapsed').treeview({
        levels: 1,
        data: defaultData,
        nodeIcon: "icon icon_folder"
    });
    $('#expandedTreeview').treeview({
        levels: 99,
        data: defaultData,
        nodeIcon: "icon icon_folder"
    });
    $('#customIconstreeview').treeview({
        expandIcon: 'icon arrow_carrot-right',
        collapseIcon: 'icon arrow_carrot-down',
        nodeIcon: 'icon icon_ribbon',
        data: defaultData
    });
    $('#treeviewTagsAsBadges').treeview({
        expandIcon: "icon icon_check",
        collapseIcon: "icon icon_check_alt",
        nodeIcon: "icon icon_profile",
        showTags: true,
        data: defaultData
    });
    
    var $searchableTree = $('#treeview-searchable').treeview({
          data: defaultData,
          nodeIcon: "icon icon_folder"
        });
    
    var search = function(e) {
          var pattern = $('#inputSearchable').val();
          var options = {
            ignoreCase: $('#chk-ignore-case').is(':checked'),
            exactMatch: $('#chk-exact-match').is(':checked'),
            revealResults: $('#chk-reveal-results').is(':checked')
          };
          var results = $searchableTree.treeview('search', [ pattern, options ]);
        }
        $('#inputSearchable').on('keyup', search);

        
    var $tree = $('#pageJsonData').treeview({
        data: json,
        nodeIcon: "icon icon_folder"
    });

    var $expandibleTree = $('#treeview-expandible').treeview({
        data: defaultData,
        nodeIcon: "icon icon_folder"
    });

    var findExpandibleNodess = function () {
        return $expandibleTree.treeview('search', [$('#input-expand-node').val(), {ignoreCase: false, exactMatch: false}]);
    };

    var expandibleNodes = findExpandibleNodess();

    $('#input-expand-node').on('keyup', function (e) {
        expandibleNodes = findExpandibleNodess();
        $('.expand-node').prop('disabled', !(expandibleNodes.length >= 1));
    });

    var $expandibleTree1 = $('#treeviewexpandible').treeview({
        data: defaultData,
        nodeIcon: "icon icon_folder"
    });

    var findExpandibleNodess1 = function () {
        return $expandibleTree1.treeview('search', [$('#input-expand-node').val(), {ignoreCase: false, exactMatch: false}]);
    };
    var expandibleNodes1 = findExpandibleNodess1();

    $("#pageExpandAll").on("click", function (e) {
        $expandibleTree1.treeview("expandAll", {levels: "99"});
    }), $("#pageCollapseAll").on("click", function (e) {
        $expandibleTree1.treeview("collapseAll");
    });


    var events_toastr = function (msg) {
        toastr.info(msg, "", {iconClass: "toast-just-text btn-info", positionClass: "toast-bottom-right", containertId: "toast-bottom-right"});
    }, options = {data: defaultData, nodeIcon: "icon icon_folder", onNodeCollapsed: function (event, node) {
            events_toastr(node.text + " was collapsed");
        }, onNodeExpanded: function (event, node) {
            events_toastr(node.text + " was expanded");
        }, onNodeSelected: function (event, node) {
            events_toastr(node.text + " was selected");
        }, onNodeUnselected: function (event, node) {
            events_toastr(node.text + " was unselected");
        }};
    $("#pageEvents").treeview(options);

});